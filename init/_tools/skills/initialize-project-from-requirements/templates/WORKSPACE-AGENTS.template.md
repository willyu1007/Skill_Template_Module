# init/_work — Initialization workspace (operating rules)

`init/_work/` is the init pipeline **workspace**. The folder holds the Stage A/B single sources of truth (SSOT) and the pipeline runtime state.

The init pipeline `start` command generates the guide (copy-if-missing) at `init/_work/AGENTS.md`.
If you want to restore the latest template, delete `init/_work/AGENTS.md` and re-run `start` (or run any pipeline command after init has started).

The workspace guide is intentionally written in English (operator/LLM-facing). Stage A docs may use the project’s chosen output language (see `init/START-HERE.md`).

## Read first (high-signal rules)

- Only write **durable, reviewable artifacts** into `init/_work/`:
  - Stage A SSOT (human-readable): `init/_work/stage-a-docs/*`
  - Stage B SSOT (machine-readable): `init/_work/project-blueprint.json`
- Never hand-edit the pipeline state file: `init/_work/.init-state.json` (pipeline-owned).
- Do not store raw source materials in the repo (PDFs, screenshots, long transcripts). Extract the conclusions into Stage A/B SSOT instead.
- Treat file/folder names under `init/_work/` as part of the pipeline contract: do not rename `stage-a-docs/`, `project-blueprint.json`, or `.init-state.json`.
- Keep secrets out of all init files (no tokens, passwords, connection strings).

## What lives here (and how to use the workspace)

### `init/_work/.init-state.json` (runtime state; pipeline-owned)

- Created/updated by `init-pipeline.mjs`.
- Drives progress reporting and the derived board: `init/INIT-BOARD.md`.
- MUST NOT be edited by hand.
- Restart policy:
  - To restart init, delete `init/_work/.init-state.json`, then re-run `start`.
  - Optional: also delete `init/_work/stage-a-docs/*` and `init/_work/project-blueprint.json` if you want a clean slate.

Note: `.gitignore` ignores the state file by default, so the file does not pollute review diffs.

### `init/_work/stage-a-docs/` (Stage A SSOT; requirements docs)

The `stage-a-docs/` folder contains 4 required documents:

- `requirements.md`
- `non-functional-requirements.md`
- `domain-glossary.md`
- `risk-open-questions.md` (all TBDs must converge here with owner + options + decision due)

Rules:

- Keep the template headings; replace all placeholders.
- “TBD” is allowed, but every TBD MUST be tracked in `risk-open-questions.md` with enough context for someone else to resolve later.

Validation (required before Stage A approval):

```bash
node init/_tools/skills/initialize-project-from-requirements/scripts/init-pipeline.mjs check-docs \
  --repo-root . \
  --docs-root init/_work/stage-a-docs \
  --strict
```

### `init/_work/project-blueprint.json` (Stage B SSOT; blueprint)

The blueprint file (`init/_work/project-blueprint.json`) encodes **decisions** that drive Stage C:

- minimal scaffold shape
- config generation strategy
- skill packs / feature selection

Rules:

- Only encode decisions needed to drive scaffold/config/packs/features.
- Avoid implementation detail and speculation (keep the blueprint stable and auditable).
- Never store secrets.

Validation (required before Stage B approval):

```bash
node init/_tools/skills/initialize-project-from-requirements/scripts/init-pipeline.mjs validate \
  --repo-root . \
  --blueprint init/_work/project-blueprint.json
```

Optional recommendations:

```bash
node init/_tools/skills/initialize-project-from-requirements/scripts/init-pipeline.mjs suggest-packs --repo-root .
node init/_tools/skills/initialize-project-from-requirements/scripts/init-pipeline.mjs suggest-features --repo-root .
```

### `init/_work/skill-retention-table.template.md` (Stage C requirement)

Generated by Stage C `apply`. Fill the table and then record the review:

```bash
node init/_tools/skills/initialize-project-from-requirements/scripts/init-pipeline.mjs review-skill-retention --repo-root .
```

## How the workspace relates to other init files

- `init/README.md`: human-facing overview and commands.
- `init/AGENTS.md`: LLM/operator rules (checkpointing, approvals, safety).
- `init/START-HERE.md`: entry doc created by `start` (chosen output language + routing map).
- `init/INIT-BOARD.md`: derived board created after `start` and refreshed after pipeline commands (do not edit).
- `init/_tools/**`: init kit tooling (scripts, templates, deep-dive docs).

## After init: archive + optional cleanup

After Stage C approval, you may archive and remove the init kit:

```bash
node init/_tools/skills/initialize-project-from-requirements/scripts/init-pipeline.mjs cleanup-init \
  --repo-root . \
  --apply \
  --i-understand \
  --archive
```
